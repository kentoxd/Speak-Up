<ion-header [translucent]="true">
  <ion-toolbar>
    <ion-title>Learn</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">

  <div class="learn-container">
    
    <!-- Progress Summary -->
    <ion-card class="progress-summary">
      <ion-card-content>
        <div class="summary-content">
          <div class="summary-text">
            <h3>Your Progress</h3>
            <p>{{ getCompletedTopicsCount() }} of {{ getTotalTopicsCount() }} Topics completed</p>
            <p>{{ Math.round(overallProgress) }}% Overall Progress</p>
          </div>
          <div class="summary-icon">
            <ion-icon name="trophy" color="warning"></ion-icon>
          </div>
        </div>
        <ion-progress-bar 
          [value]="overallProgress / 100" 
          color="secondary">
        </ion-progress-bar>
      </ion-card-content>
    </ion-card>

    <!-- Topics Section -->
    <div class="topics-section">
      <h2>Topics</h2>
      
      <div class="topics-list">
        <ion-card 
          *ngFor="let topic of topics" 
          class="topic-card"
          (click)="openTopic(topic)">
          
          <ion-card-content>
            <div class="topic-header">
              <div class="topic-info">
                <h3>{{ topic.title }}</h3>
                <p>{{ topic.description }}</p>
              </div>
              <div class="topic-status">
                <ion-icon 
                  *ngIf="isTopicCompleted(topic.id)"
                  name="checkmark-circle" 
                  color="success">
                </ion-icon>
                <ion-icon 
                  *ngIf="!isTopicCompleted(topic.id) && (getTopicProgress(topic.id)?.progress || 0) > 0"
                  name="play-circle" 
                  color="primary">
                </ion-icon>
                <ion-icon 
                  *ngIf="!getTopicProgress(topic.id) || getTopicProgress(topic.id)?.progress === 0"
                  name="lock-closed" 
                  color="medium">
                </ion-icon>
              </div>
            </div>
            
            <div class="topic-progress">
              <div class="progress-info">
                <span *ngIf="getTopicProgress(topic.id)">
                  {{ getTopicProgress(topic.id)?.lessonsCompleted || 0 }} of 5 lessons completed
                </span>
                <span *ngIf="!getTopicProgress(topic.id)">
                  0 of 5 lessons completed
                </span>
              </div>
              <ion-progress-bar 
                [value]="(getTopicProgress(topic.id)?.progress || 0) / 100"
                color="secondary">
              </ion-progress-bar>
            </div>

            <div class="topic-actions">
              <ion-button 
                fill="outline" 
                size="small"
                (click)="openTopic(topic); $event.stopPropagation()">
                View Lessons
              </ion-button>
              <ion-button 
                *ngIf="isQuizUnlocked(topic.id)"
                fill="solid" 
                size="small"
                color="tertiary"
                (click)="startQuiz(topic); $event.stopPropagation()">
                Take Quiz
              </ion-button>
            </div>
          </ion-card-content>
        </ion-card>
      </div>
    </div>

  </div>
</ion-content>
