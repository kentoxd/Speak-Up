<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button fill="clear" (click)="goBack()">
        <ion-icon name="arrow-back" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-title>Verify Email</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="email-verification-content">
  <div class="email-verification-container">
    <div class="form-section">
      <div class="form-header">
        <div class="verification-icon">
          <ion-icon name="mail" color="primary"></ion-icon>
        </div>
        <h1>Verify Your Email</h1>
        <p>We've sent a 6-digit verification code to</p>
        <div class="email-display">{{ userEmail }}</div>
        <p>Please enter the code below to complete your verification.</p>
      </div>

      <form [formGroup]="verificationForm" (ngSubmit)="onSubmit()">
        <!-- OTP Input -->
        <div class="form-group">
          <ion-item>
            <ion-label position="stacked">Verification Code *</ion-label>
            <ion-input
              type="text"
              formControlName="otp"
              placeholder="Enter 6-digit code"
              maxlength="6"
              (input)="onOTPInput($event)">
            </ion-input>
          </ion-item>
          <div class="error-message" *ngIf="getFieldError('otp')">
            {{ getFieldError('otp') }}
          </div>
        </div>

        <!-- Submit Button -->
        <ion-button
          expand="block"
          [disabled]="!verificationForm.valid || isLoading"
          (click)="onSubmit()"
          class="submit-btn">
          <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
          <span *ngIf="!isLoading">Verify Email</span>
        </ion-button>
      </form>

      <!-- Resend Section -->
      <div class="resend-section">
        <p>Didn't receive the code?</p>
        <ion-button
          fill="clear"
          [disabled]="!canResend || isLoading"
          (click)="resendOTP()"
          class="resend-btn">
          <span *ngIf="canResend">Resend Code</span>
          <span *ngIf="!canResend">Resend in {{ countdown }}s</span>
        </ion-button>
      </div>

      <!-- Help Text -->
      <div class="help-text">
        <p>Check your spam folder if you don't see the email.</p>
        <p>Make sure to enter the code within 10 minutes.</p>
      </div>
    </div>
  </div>
</ion-content>
